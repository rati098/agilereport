"use strict";!function(s,t,l,a){var e="agilereport";function i(t,a){if(this.element=t,this.$element=s(t),this.SortMonth=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],this.FullMonth=["January","February","March","April","May","June","July","August","September","Octomber","November","December"],this.options=s.extend({div_class:"",halign:"",no_of_rows:15,dtformatcols:{},csv_download:!0,csv_file_name:"data.csv",excel_download:!0,excel_file_name:"data.xlsx",excel_parameter_tab:!1,excel_parameter_string:"",numformatcols:{},sorting:!0,report_type:"lazy_load",callback:function(t){}},a),this._defaults=this.options,this._name=e,this.header_arr=[],this.html="",this.temp="",this.controls={paginationSize:0,srow:"",erow:"",current_position:""},"destroy"!=a)if(this.p_halign=[],a.data&&0!=a.data.length){for(var i in a.data[0])this.header_arr.push(i),this.p_halign.push("left");this._defaults.halign=this.p_halign,this.agile_data=this._defaults.data,this.controls.paginationSize=Number(this._defaults.no_of_rows),this.GenerateHeader(this._defaults,this.$element),this.GenerateBody(this._defaults,this.$element),this.FilterReport(this._defaults,this.$element),this._defaults.callback(this)}else this.html("No Data Found !").addClass("agile_no_data");else destroy.call(this)}i.prototype.GenerateHeader=function(i,e){e.html('<div id="'.concat(e.attr("id")+"_wrapper",'" class="agile_wrapper">\n                <div id="').concat(e.attr("id")+"_container",'" class="agile_top_tools">\n                <input id="').concat(e.attr("id")+"_input",'" type="search" placeholder="Search" />\n                <ul class="agile_suggest"></ul><div class="agile_down">\n                <ul>').concat(i.csv_download?'<li class="csv">Download CSV</li>':"").concat(i.excel_download?'<li class="excel">Download Excel</li>':"",'</ul></div></div>\n                <div id="').concat(e.attr("id")+"_report",'" class="json2agilereport ').concat(i.div_class,'">\n                <table class="report_table">\n                  <thead>\n                    <tr class=').concat(i.sorting?'"agile_sort"':'""',"></tr>\n                  </thead>\n                  <tbody>\n                  </tbody>\n                </table>\n                </div>\n                </div>\n                ")),s("#"+e.attr("id")+"_wrapper,#"+e.attr("id")+"_report .report_table,#"+e.attr("id")+"_report").css({width:"100%",margin:"0 auto"}),s("#"+e.attr("id")+"_report").scroll(function(){s("#"+e.attr("id")+"_report .agile_sort th").css({position:"relative",top:s(this).scrollTop(),background:"#fff"})}),i.csv_download||i.excel_download||s(".agile_down").remove(),s(".agile_down .csv").click(function(){}),s(".agile_down .excel").click(function(){}),i.table_header&&s("#"+e.attr("id")+"_wrapper").prepend('<div class="theader">'.concat(i.table_header,"</div>")),this.header_arr.forEach(function(t,a){s("#"+e.attr("id")+"_report thead tr").append('<th align="'.concat(i.halign[a],'" data-key="').concat(t,'">').concat(t,"</th>"))}),i.sorting&&this.EnableSorting(i,e)},i.prototype.GenerateBody=function(e,o){var n=this;"lazy_load"==e.report_type||"pagination"==e.report_type?(this.controls.srow=1,this.controls.erow=this.controls.paginationSize):(this.controls.srow=1,this.controls.erow=this.agile_data.length),this.AppendRows(e,o),"pagination"==e.report_type?(s("#"+o.attr("id")+"_wrapper").append('<div class="agile_bottom_tools">\n      <input type="text" id="'.concat(o.attr("id")+"_limit",'" value="').concat(this.controls.paginationSize,'"><span> rows per page</span>\n      <div class="pagination" id="').concat(o.attr("id")+"_pagination",'"></div></div>')),this.SetPagination(e,o),s("#"+o.attr("id")+"_limit").change(function(){n.controls.paginationSize=Number(s(this).val()),n.agile_data=e.data,n.controls.srow=1,n.controls.erow=n.controls.paginationSize,s("#"+o.attr("id")+"_report tbody").html(""),n.AppendRows(e,o),n.SetPagination(e,o),e.callback(n)})):"lazy_load"==e.report_type&&s("#"+o.attr("id")+"_report").scrollTop(0).scroll(function(t){var a=s(this),i=a.children("table");a.scrollTop()>=i.height()-a.height()&&(this.controls.srow=this.controls.current_position+1,this.controls.erow=this.controls.current_position+this.controls.paginationSize,this.AppendRows(e,o),e.callback(n))})},i.prototype.AppendRows=function(i,t){var e=this;if(!(this.agile_data.length<this.controls.srow)){this.controls.erow=this.agile_data.length<this.controls.erow?this.agile_data.length:this.controls.erow;for(var a=this.controls.srow-1;a<this.controls.erow;a++)this.temp=this.agile_data[a],this.html="<tr>",this.header_arr.forEach(function(t,a){e.html+='<td align="'.concat(i.halign[a],'">\n        ').concat(-1<JSON.stringify(i.dtformatcols).indexOf('"'+t+'"')?e.FormatDate(new Date(e.temp[t]),i.dtformatcols[t]):-1<JSON.stringify(i.numformatcols).indexOf('"'+t+'"')?e.FormatNumber(e.temp[t],i.numformatcols[t]):e.temp[t],"</td>")}),this.html+="</tr>",s("#"+t.attr("id")+"_report tbody").append(this.html);this.controls.current_position=this.controls.erow}},i.prototype.FormatNumber=function(t,a){return t&&(a.decimals&&(t=t.toFixed(a.decimals).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")),a.number_prefix&&Number(t.replace(/\,/g,""))<0?t='<span class="negative">('+a.number_prefix+t.replace(/\-/,"")+")</span>":a.number_prefix?t=a.number_prefix+t:a.number_suffix&&Number(t.replace(/\,/g,""))<0?t='<span class="negative">('+t.replace(/\-/,"")+a.number_suffix+")</span>":a.number_suffix&&(t+=a.number_suffix)),t},i.prototype.FormatDate=function(t,a){return"dd-mm-yyyy"==a?t.getDate()+"-"+(t.getMonth()+1)+"-"+t.getFullYear():"dd/mm/yyyy"==a?t.getDate()+"-"+(t.getMonth()+1)+"-"+t.getFullYear():"mm-dd-yyyy"==a?t.getMonth()+1+"-"+t.getDate()+"-"+t.getFullYear():"mm/dd/yyyy"==a?t.getMonth()+1+"/"+t.getDate()+"/"+t.getFullYear():"dd/mon/yyyy"==a?t.getDate()+"/"+this.SortMonth[t.getMonth()]+"/"+t.getFullYear():"dd-mon-yyyy"==a?t.getDate()+"-"+this.SortMonth[t.getMonth()]+"-"+t.getFullYear():"dd mon yyyy"==a?t.getDate()+" "+this.SortMonth[t.getMonth()]+" "+t.getFullYear():"dd month yyyy"==a?t.getDate()+" "+this.FullMonth[t.getMonth()]+" "+t.getFullYear():"month dd,yyyy"==a?this.FullMonth[t.getMonth()]+" "+t.getDate()+","+t.getFullYear():this.SortMonth[t.getMonth()]+"_"+t.getDate()+"_"+t.getFullYear()},i.prototype.EnableSorting=function(a,i){var e=this;s("#"+i.attr("id")+"_report th").click(function(){s("#"+i.attr("id")+"_container").addClass("loading");var t=s(this).data("key");s(this).hasClass("asc")?(s("#"+i.attr("id")+"_report th").removeClass("asc").removeClass("desc"),e.SortByKeyDesc(a.data,t),s(this).addClass("desc")):(s("#"+i.attr("id")+"_report th").removeClass("asc").removeClass("desc"),e.SortByKey(a.data,t),s(this).addClass("asc")),s("#"+i.attr("id")+"_report tbody").html(""),"lazy_load"==a.report_type||"pagination"==a.report_type?(e.controls.srow=1,e.controls.erow=e.controls.paginationSize):(e.controls.srow=1,e.controls.erow=a.data.length),e.AppendRows(a,i),e.SetPagination(a,i),s("#"+i.attr("id")+"_container").removeClass("loading"),a.callback.call(this)})},i.prototype.SortByKey=function(t,o){return t.sort(function(t,a){var i=t[o],e=a[o];return i<e?-1:e<i?1:0})},i.prototype.SortByKeyDesc=function(t,o){return t.sort(function(t,a){var i=t[o],e=a[o];return e<i?-1:i<e?1:0})},i.prototype.SetPagination=function(o,n){var t,r=this,a=Math.ceil(this.controls.current_position/this.controls.paginationSize);for(this.html='<a href="javascript:void(0)" class="agile_prevset">&lt;&lt;</a><a href="javascript:void(0)" class="agile_prev">&lt;</a>',t=1;t<=Math.ceil(o.data.length/this.controls.paginationSize);t++)this.html+=t==a?'<a href="javascript:void(0)" class="active">'.concat(t,"</a>"):3<t?'<a href="javascript:void(0)" class="agile_hide">'.concat(t,"</a>"):'<a href="javascript:void(0)">'.concat(t,"</a>");this.html+='<a href="javascript:void(0)" class="agile_next">&gt;</a><a href="javascript:void(0)" class="agile_nextset">&gt;&gt;</a>',s("#"+n.attr("id")+"_pagination").html(this.html),t<=4&&s("#"+n.attr("id")+"_pagination a.agile_prevset,#"+n.attr("id")+"_pagination a.agile_nextset").remove(),3==s("#"+n.attr("id")+"_pagination a").length&&s("#"+n.attr("id")+"_pagination a.agile_prev, #"+n.attr("id")+"_pagination a.agile_next").remove(),s("#"+n.attr("id")+"_pagination a").click(function(){if(!(s(this).hasClass("agile_prev")||s(this).hasClass("agile_next")||s(this).hasClass("agile_nextset")||s(this).hasClass("agile_prevset"))){var t=s(this).text();s("#"+n.attr("id")+"_container").addClass("loading"),r.controls.srow=(t-1)*r.controls.paginationSize+1,r.controls.erow=r.controls.srow+r.controls.paginationSize-1,s("#"+n.attr("id")+"_report tbody").html(""),r.AppendRows(o,n),s("#"+n.attr("id")+"_pagination a.active").removeClass("active"),s(this).addClass("active"),s("#"+n.attr("id")+"_container").removeClass("loading"),o.callback(r)}}),s("#"+n.attr("id")+"_pagination a.agile_prev").click(function(){var t=Number(s("#"+n.attr("id")+"_pagination a.active").text())-1;s("#"+n.attr("id")+"_pagination a.active").hasClass("agile_hide")&&(t=Number(s("#"+n.attr("id")+'_pagination a:not([class*="agile_"])')[0].innerHTML)),0!=t&&(s("#"+n.attr("id")+"_container").addClass("loading"),r.controls.srow=(t-1)*r.controls.paginationSize+1,r.controls.erow=r.controls.srow+r.controls.paginationSize-1,s("#"+n.attr("id")+"_report tbody").html(""),r.AppendRows(o,n),s("#"+n.attr("id")+"_pagination a.active").hasClass("agile_hide")?(s("#"+n.attr("id")+"_pagination a.active:eq(0)").removeClass("active"),s("#"+n.attr("id")+"_pagination a").each(function(){s(this).text()==t&&s(this).addClass("active")})):(s("#"+n.attr("id")+"_pagination a.active").prev().addClass("active"),s("#"+n.attr("id")+"_pagination a.active:eq(1)").removeClass("active"),s("#"+n.attr("id")+"_pagination a").each(function(){s(this).text()==t&&s(this).hasClass("agile_hide")&&(s(this).removeClass("agile_hide"),s(this).next().next().next().addClass("agile_hide"))})),s("#"+n.attr("id")+"_container").removeClass("loading"),o.callback(r))}),s("#"+n.attr("id")+"_pagination a.agile_next").click(function(){var t=Number(s("#"+n.attr("id")+"_pagination a.active").text())+1;s("#"+n.attr("id")+"_pagination a.active").hasClass("agile_hide")&&(t=Number(s("#"+n.attr("id")+'_pagination a:not([class*="agile_"])')[0].innerHTML)),t>Math.ceil(o.data.length/r.controls.paginationSize)||(s("#"+n.attr("id")+"_container").addClass("loading"),r.controls.srow=(t-1)*r.controls.paginationSize+1,r.controls.erow=r.controls.srow+r.controls.paginationSize-1,s("#"+n.attr("id")+"_report tbody").html(""),r.AppendRows(o,n),s("#"+n.attr("id")+"_pagination a.active").hasClass("agile_hide")?(s("#"+n.attr("id")+"_pagination a.active:eq(0)").removeClass("active"),s("#"+n.attr("id")+"_pagination a").each(function(){s(this).text()==t&&s(this).addClass("active")})):(s("#"+n.attr("id")+"_pagination a.active").next().addClass("active"),s("#"+n.attr("id")+"_pagination a.active:eq(0)").removeClass("active"),s("#"+n.attr("id")+"_pagination a").each(function(){s(this).text()==t&&s(this).hasClass("agile_hide")&&(s(this).removeClass("agile_hide"),s(this).prev().prev().prev().addClass("agile_hide"))})),s("#"+n.attr("id")+"_container").removeClass("loading"),o.callback(r))}),s("#"+n.attr("id")+"_pagination a.agile_nextset").click(function(){var a=s("#"+n.attr("id")+'_pagination a:not([class*="agile_"])'),i=Number(a[a.length-1].innerHTML);if(i&&i!=Math.ceil(o.data.length/r.controls.paginationSize)){for(var t=function(t){s("#"+n.attr("id")+"_pagination a").each(function(){s(this).text()==i+t&&s(this).hasClass("agile_hide")&&(s(this).removeClass("agile_hide"),s(a[t-1]).addClass("agile_hide"))})},e=1;e<=3;e++)t(e);o.callback(r)}}),s("#"+n.attr("id")+"_pagination a.agile_prevset").click(function(){var a=s("#"+n.attr("id")+'_pagination a:not([class*="agile_"])'),i=Number(a[0].innerHTML);if(i&&1!=i){for(var t=function(t){s("#"+n.attr("id")+"_pagination a").each(function(){s(this).text()==i-t&&s(this).hasClass("agile_hide")&&(s(this).removeClass("agile_hide"),s(a[a.length-t]).addClass("agile_hide"))})},e=1;e<=3;e++)t(e);o.callback(r)}})},i.prototype.FilterReport=function(n,a){var i,e,o,r=this;s("#"+a.attr("id")+"_input").bind("change paste keyup",function(){s("#"+a.attr("id")+"_container").addClass("loading"),s("#"+a.attr("id")+"_report thead th").removeClass("asc").removeClass("desc")}),s("#"+a.attr("id")+"_input").bind("change paste keyup",(i=function(t){var o=s(this).val().toUpperCase();r.html="",r.agile_data=[],0<o.length?(n.data.forEach(function(i,e){r.header_arr.forEach(function(t,a){r.temp=i[t],-1<r.temp.toString().toUpperCase().indexOf(o)&&(r.agile_data.push(n.data[e]),-1==r.html.indexOf(i[t])&&(r.html=r.html+"<li>".concat(i[t],"</li>")))})}),s("#"+a.attr("id")+"_container ul.agile_suggest").html(r.html),s("#"+a.attr("id")+"_input").is(":focus")&&s("#"+a.attr("id")+"_container ul.agile_suggest").show(),s("#"+a.attr("id")+"_container ul.agile_suggest li").click(function(){s("#"+a.attr("id")+"_input").val(s(this).text())})):r.agile_data=n.data,r.controls.srow=1,r.controls.erow=r.controls.paginationSize,s("#"+a.attr("id")+"_report tbody").html(""),r.AppendRows(n,a),r.SetPagination(n,a),"pagination"==n.report_type&&0==r.agile_data.length?s("#"+a.attr("id")+"_wrapper .agile_bottom_tools").hide():s("#"+a.attr("id")+"_wrapper .agile_bottom_tools").show(),0==r.agile_data.length&&s("#"+a.attr("id")+"_report tbody").append('<tr><td align="center" colspan="'.concat(r.header_arr.length,'" style="font-size: 11px;color: #d40e0e;font-weight: bold;">No Matching Record !</td></tr>')),s("#"+a.attr("id")+"_container").removeClass("loading"),n.callback(r)},e=700,o=0,function(){var t=this,a=arguments;clearTimeout(o),o=setTimeout(function(){i.apply(t,a)},e||0)})),s(l).mouseup(function(){s("#"+a.attr("id")+"_container ul.agile_suggest").hide()})},i.prototype.destroy=function(t,a){this.header_arr=[],this.html="",this.temp="",this.controls={paginationSize:0,srow:"",erow:"",current_position:""},this.agile_data=[],a.html("")},s.fn[e]=function(t){return this.each(function(){s.data(this,"plugin_"+e)||s.data(this,"plugin_"+e,new i(this,t))})}}(jQuery,window,document);