"use strict";function _typeof(a){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,function(s){var l,n,r=[],c=[],g="",p={psize:0,srow:"",erow:"",curr_pos:""},d="",t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],i=["January","February","March","April","May","June","July","August","September","Octomber","November","December"];function h(){if(!(r.length<p.srow)){p.erow=r.length<p.erow?r.length:p.erow;for(var a=p.srow-1;a<p.erow;a++)l=r[a],g="<tr>",c.forEach(function(a,e){g+='<td align="'.concat(n.halign[e],'">').concat(-1<JSON.stringify(n.dtformatcols).indexOf('"'+a+'"')?f(new Date(l[a]),n.dtformatcols[a]):-1<JSON.stringify(n.numformatcols).indexOf('"'+a+'"')?u(l[a],n.numformatcols[a]):l[a],"</td>")}),g+="</tr>",s(".json2agilereport tbody").append(g);p.curr_pos=p.erow}}function _(){var a,e=Math.ceil(p.curr_pos/p.psize);for(g='<a href="javascript:void(0)" class="agile_prevset">&lt;&lt;</a><a href="javascript:void(0)" class="agile_prev">&lt;</a>',a=1;a<=Math.ceil(r.length/p.psize);a++)g+=a==e?'<a href="javascript:void(0)" class="active">'.concat(a,"</a>"):3<a?'<a href="javascript:void(0)" class="agile_hide">'.concat(a,"</a>"):'<a href="javascript:void(0)">'.concat(a,"</a>");g+='<a href="javascript:void(0)" class="agile_next">&gt;</a><a href="javascript:void(0)" class="agile_nextset">&gt;&gt;</a>',s(".pagination").html(g),a<=4&&s("a.agile_prevset,a.agile_nextset").remove(),3==s(".agile_bottom_tools .pagination a").length&&s("a.agile_prev,a.agile_next").remove(),s(".pagination a").click(function(){if(!(s(this).hasClass("agile_prev")||s(this).hasClass("agile_next")||s(this).hasClass("agile_nextset")||s(this).hasClass("agile_prevset"))){var a=s(this).text();s(".agile_top_tools").addClass("loading"),p.srow=(a-1)*p.psize+1,p.erow=p.srow+p.psize-1,s(".json2agilereport tbody").html(""),h.call(this),s(".pagination a.active").removeClass("active"),s(this).addClass("active"),s(".agile_top_tools").removeClass("loading"),n.callback.call(this)}}),s(".pagination a.agile_prev").click(function(){var a=Number(s(".pagination a.active").text())-1;s(".pagination a.active").hasClass("agile_hide")&&(a=Number(s('.pagination a:not([class*="agile_"])')[0].innerHTML)),0!=a&&(s(".agile_top_tools").addClass("loading"),p.srow=(a-1)*p.psize+1,p.erow=p.srow+p.psize-1,s(".json2agilereport tbody").html(""),h.call(this),s(".pagination a.active").hasClass("agile_hide")?(s(".pagination a.active:eq(0)").removeClass("active"),s(".pagination a").each(function(){s(this).text()==a&&s(this).addClass("active")})):(s(".pagination a.active").prev().addClass("active"),s(".pagination a.active:eq(1)").removeClass("active"),s(".pagination a").each(function(){s(this).text()==a&&s(this).hasClass("agile_hide")&&(s(this).removeClass("agile_hide"),s(this).next().next().next().addClass("agile_hide"))})),s(".agile_top_tools").removeClass("loading"),n.callback.call(this))}),s(".pagination a.agile_next").click(function(){var a=Number(s(".pagination a.active").text())+1;s(".pagination a.active").hasClass("agile_hide")&&(a=Number(s('.pagination a:not([class*="agile_"])')[0].innerHTML)),a>Math.ceil(r.length/p.psize)||(s(".agile_top_tools").addClass("loading"),p.srow=(a-1)*p.psize+1,p.erow=p.srow+p.psize-1,s(".json2agilereport tbody").html(""),h.call(this),s(".pagination a.active").hasClass("agile_hide")?(s(".pagination a.active:eq(0)").removeClass("active"),s(".pagination a").each(function(){s(this).text()==a&&s(this).addClass("active")})):(s(".pagination a.active").next().addClass("active"),s(".pagination a.active:eq(0)").removeClass("active"),s(".pagination a").each(function(){s(this).text()==a&&s(this).hasClass("agile_hide")&&(s(this).removeClass("agile_hide"),s(this).prev().prev().prev().addClass("agile_hide"))})),s(".agile_top_tools").removeClass("loading"),n.callback.call(this))}),s(".pagination a.agile_nextset").click(function(){var e=s('.pagination a:not([class*="agile_"])'),t=Number(e[e.length-1].innerHTML);if(t&&t!=Math.ceil(r.length/p.psize)){for(var a=function(a){s(".pagination a").each(function(){s(this).text()==t+a&&s(this).hasClass("agile_hide")&&(s(this).removeClass("agile_hide"),s(e[a-1]).addClass("agile_hide"))})},i=1;i<=3;i++)a(i);n.callback.call(this)}}),s(".pagination a.agile_prevset").click(function(){var e=s('.pagination a:not([class*="agile_"])'),t=Number(e[0].innerHTML);if(t&&1!=t){for(var a=function(a){s(".pagination a").each(function(){s(this).text()==t-a&&s(this).hasClass("agile_hide")&&(s(this).removeClass("agile_hide"),s(e[e.length-a]).addClass("agile_hide"))})},i=1;i<=3;i++)a(i);n.callback.call(this)}})}function u(a,e){return a&&(e.decimals&&(a=a.toFixed(e.decimals).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")),e.number_prefix&&Number(a.replace(/\,/g,""))<0?a='<span class="negative">('+e.number_prefix+a.replace(/\-/,"")+")</span>":e.number_prefix?a=e.number_prefix+a:e.number_suffix&&Number(a.replace(/\,/g,""))<0?a='<span class="negative">('+a.replace(/\-/,"")+e.number_suffix+")</span>":e.number_suffix&&(a+=e.number_suffix)),a}function f(a,e){return"dd-mm-yyyy"==e?a.getDate()+"-"+(a.getMonth()+1)+"-"+a.getFullYear():"dd/mm/yyyy"==e?a.getDate()+"-"+(a.getMonth()+1)+"-"+a.getFullYear():"mm-dd-yyyy"==e?a.getMonth()+1+"-"+a.getDate()+"-"+a.getFullYear():"mm/dd/yyyy"==e?a.getMonth()+1+"/"+a.getDate()+"/"+a.getFullYear():"dd/mon/yyyy"==e?a.getDate()+"/"+t[a.getMonth()]+"/"+a.getFullYear():"dd-mon-yyyy"==e?a.getDate()+"-"+t[a.getMonth()]+"-"+a.getFullYear():"dd mon yyyy"==e?a.getDate()+" "+t[a.getMonth()]+" "+a.getFullYear():"dd month yyyy"==e?a.getDate()+" "+i[a.getMonth()]+" "+a.getFullYear():"month dd,yyyy"==e?i[a.getMonth()]+" "+a.getDate()+","+a.getFullYear():t[a.getMonth()]+"_"+a.getDate()+"_"+a.getFullYear()}s.fn.agilereport=function(a){if("destroy"!=a){var e=[];if(a.data&&0!=a.data.length){for(var t in a.data[0])c.push(t),e.push("left");return n=s.extend({div_class:"",halign:e,no_of_rows:15,dtformatcols:{},csv_download:!0,csv_file_name:"data.csv",excel_download:!0,excel_file_name:"data.xlsx",excel_parameter_tab:!1,excel_parameter_string:"",numformatcols:{},sorting:!0,report_type:"lazy_load",callback:function(){}},a),p.psize=Number(n.no_of_rows),function(){this.html('<div class="agile_wrapper">\n                <div class="agile_top_tools"><input type="search" placeholder="Search"><ul class="agile_suggest"></ul><div class="agile_down"><ul>'.concat(n.csv_download?'<li class="csv">Download CSV</li>':"").concat(n.excel_download?'<li class="excel">Download Excel</li>':"",'</ul></div></div>\n                <div class="json2agilereport ').concat(n.div_class,'">\n                <table>\n                  <thead>\n                    <tr class=').concat(n.sorting?'"agile_sort"':'""',"></tr>\n                  </thead>\n                  <tbody>\n                  </tbody>\n                </table>\n                </div>\n                </div>\n                ")),n.csv_download||n.excel_download||s(".agile_down").remove();s(".agile_down .csv").click(function(){var a;(a=document.createElement("a")).href="data:text/csv;charset=utf-8,"+function(a){var e="object"!=_typeof(a)?JSON.parse(a):a,t="",i="";for(var o in c)""!=i&&(i+=","),i+=c[o];t+=i+"\r\n";for(var l=0;l<e.length;l++){for(var o in i="",e[l]){var s=e[l][o];""!=i&&(i+=","),-1<(s=-1<JSON.stringify(n.dtformatcols).indexOf('"'+o+'"')?f(new Date(s),n.dtformatcols[o]):-1<JSON.stringify(n.numformatcols).indexOf('"'+o+'"')?u(s,n.numformatcols[o]):s).toString().indexOf(",")&&(s='"'+s+'"'),i+=s}t+=i+"\r\n"}return t}(r),a.target="_blank",a.download=n.csv_file_name.replace(".csv","")+"_"+f(new Date)+"_"+(new Date).getHours()+"_"+(new Date).getMinutes()+"_"+(new Date).getSeconds()+".csv",a.click()}),s(".agile_down .excel").click(function(){!function(){var e={};e.options={fileName:n.excel_file_name.replace(".xlsx","")+"_"+f(new Date)+"_"+(new Date).getHours()+"_"+(new Date).getMinutes()+"_"+(new Date).getSeconds()},e.tableData=[{sheetName:n.excel_file_name.replace(".xlsx",""),data:[]}];var i=[],o={},l={};if(c.forEach(function(a){i.push({style:{font:{bold:!0},fill:{patternType:"solid",fgColor:{rgb:"cccccccc"}},alignment:{horizontal:"center"}},text:a}),-1<JSON.stringify(n.numformatcols).indexOf('"'+a+'"')&&(l[a]=function(a){var e,t="###,###,###,###,##0.";if(a.decimals)for(e=0;e<a.decimals;e++)t+="0";return t=t.replace(/\.$/,""),a.number_prefix&&(t=a.number_prefix+t),a.number_suffix&&(t+=a.number_suffix),t}(n.numformatcols[a]))}),e.tableData[0].data.push(i),r.forEach(function(t){i=[],c.forEach(function(a,e){o={style:{alignment:{horizontal:n.halign[e]}},text:-1<JSON.stringify(n.dtformatcols).indexOf('"'+a+'"')?f(new Date(t[a]),n.dtformatcols[a]):t[a]},-1<JSON.stringify(n.numformatcols).indexOf('"'+a+'"')&&(o.format=l[a]),i.push(o)}),e.tableData[0].data.push(i)}),n.excel_parameter_tab){e.tableData.push({sheetName:"Parameters",data:[]});var a=n.excel_parameter_string.replace("Filters:","").split(",");a.forEach(function(a){(i=[{style:{font:{bold:!0}},text:a.split("=")[0].trim()}]).push({text:a.split("=")[1].trim()}),e.tableData[1].data.push(i)})}d.export(e.tableData,e.options)}()}),n.table_header&&s(".agile_wrapper").prepend('<div class="theader">'.concat(n.table_header,"</div>"));c.forEach(function(a,e){s(".json2agilereport thead tr").append('<th align="'.concat(n.halign[e],'" data-key="').concat(a,'">').concat(a,"</th>"))}),n.sorting&&s("tr.agile_sort th").click(function(){s(".agile_top_tools").addClass("loading");var o,l,a=s(this).data("key");s(this).hasClass("asc")?(s("tr.agile_sort th").removeClass("asc").removeClass("desc"),l=a,r.sort(function(a,e){var t=a[l],i=e[l];return i<t?-1:t<i?1:0}),s(this).addClass("desc")):(s("tr.agile_sort th").removeClass("asc").removeClass("desc"),o=a,r.sort(function(a,e){var t=a[o],i=e[o];return t<i?-1:i<t?1:0}),s(this).addClass("asc")),s(".json2agilereport tbody").html(""),"lazy_load"==n.report_type||"pagination"==n.report_type?(p.srow=1,p.erow=p.psize):(p.srow=1,p.erow=r.length),h.call(this),_(),s(".agile_top_tools").removeClass("loading"),n.callback.call(this)})}.call(this),r=n.data,function(a){"lazy_load"==n.report_type||"pagination"==n.report_type?(p.srow=1,p.erow=p.psize):(p.srow=1,p.erow=r.length);console.log("Anuj"+a),h.call(this),"pagination"==n.report_type?(s(".agile_wrapper").append('<div class="agile_bottom_tools"><input type="text" value="'.concat(p.psize,'"><span> rows per page</span><div class="pagination"></div></div>')),_(),s(".agile_bottom_tools input").change(function(){p.psize=Number(s(this).val()),r=n.data,p.srow=1,p.erow=p.psize,s(".json2agilereport tbody").html(""),h.call(this),_(),n.callback.call(this)})):"lazy_load"==n.report_type&&s(".json2agilereport").scrollTop(0).scroll(function(a){var e=s(this),t=e.children("table");e.scrollTop()>=t.height()-e.height()&&(p.srow=p.curr_pos+1,p.erow=p.curr_pos+p.psize,h.call(this),n.callback.call(this))})}.call(this),function(){s('.agile_top_tools input[type="search"]').bind("change paste keyup",function(){s(".agile_top_tools").addClass("loading"),s("tr.agile_sort th").removeClass("asc").removeClass("desc")}),s('.agile_top_tools input[type="search"]').bind("change paste keyup",(t=function(a){var o=s(this).val().toUpperCase();g="",r=[],0<o.length?(n.data.forEach(function(t,i){c.forEach(function(a,e){-1<(l=t[a]).toString().toUpperCase().indexOf(o)&&(r.push(n.data[i]),-1==g.indexOf(t[a])&&(g+="<li>".concat(t[a],"</li>")))})}),s("ul.agile_suggest").html(g),s('.agile_top_tools input[type="search"]').is(":focus")&&s("ul.agile_suggest").show(),s("ul.agile_suggest li").click(function(){s(".agile_top_tools input").val(s(this).text())})):r=n.data,p.srow=1,p.erow=p.psize,s(".json2agilereport tbody").html(""),h.call(this),_(),"pagination"==n.report_type&&0==r.length?s(".agile_bottom_tools").hide():s(".agile_bottom_tools").show(),0==r.length&&s(".json2agilereport tbody").append('<tr><td align="center" colspan="'.concat(c.length,'" style="font-size: 11px;color: #d40e0e;font-weight: bold;">No Matching Record !</td></tr>')),s(".agile_top_tools").removeClass("loading"),n.callback.call(this)},i=700,o=0,function(){var a=this,e=arguments;clearTimeout(o),o=setTimeout(function(){t.apply(a,e)},i||0)})),s(document).mouseup(function(){s(".agile_suggest").hide()});var t,i,o}.call(this),s(".json2agilereport").parent("div").css({width:s(".json2agilereport").css("width"),margin:"0 auto"}),s(".json2agilereport table").css("width",s(".json2agilereport table").css("width")),n.callback.call(this),d||reate_jhxlsx_obj(),this}this.html("No Data Found !").addClass("agile_no_data")}else(function(){r=[],c=[],p={psize:0,srow:g="",erow:"",curr_pos:""},d="",s(".agile_wrapper,.agile_wrapper *,.agile_down .excel,.agile_down .csv").off(),this.html("")}).call(this)}}(jQuery);var _default=$.fn.agilereport;exports.default=_default;