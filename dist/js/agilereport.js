"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(s,t,l,a){var i="agilereport";function e(t,a){if(this.element=t,this.$element=s(t),this.SortMonth=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],this.FullMonth=["January","February","March","April","May","June","July","August","September","Octomber","November","December"],this.options=s.extend({div_class:"",halign:[],no_of_rows:15,dtformatcols:{},csv_download:!0,csv_file_name:"data.csv",excel_download:!0,excel_file_name:"data.xlsx",excel_parameter_tab:!1,excel_parameter_string:"",numformatcols:{},sorting:!0,report_type:"lazy_load",callback:function(t){}},a),this._defaults=this.options,this._name=i,this.header_arr=[],this.html="",this.temp="",this.controls={paginationSize:0,srow:"",erow:"",current_position:""},this.Jhxlsx="","destroy"!=a)if(this.p_halign=[],a.data&&0!=a.data.length){for(var e in a.data[0])this.header_arr.push(e),this.p_halign.push("left");0==this._defaults.halign.length&&(this._defaults.halign=this.p_halign),this.agile_data=this._defaults.data,this.controls.paginationSize=Number(this._defaults.no_of_rows),this.GenerateHeader(this._defaults,this.$element),this.GenerateBody(this._defaults,this.$element),this.FilterReport(this._defaults,this.$element),this._defaults.callback(this)}else this.html("No Data Found !").addClass("agile_no_data");else this.destroy(this._defaults,this.$element)}e.prototype.GenerateHeader=function(i,o){var t=this;o.html('<div id="'.concat(o.attr("id")+"_wrapper",'" class="agile_wrapper">\n                <div id="').concat(o.attr("id")+"_container",'" class="agile_top_tools">\n                <input id="').concat(o.attr("id")+"_input",'" type="search" placeholder="Search" />\n                <ul class="agile_suggest"></ul><div class="agile_down">\n                <ul>').concat(i.csv_download?'<li class="csv">Download CSV</li>':"").concat(i.excel_download?'<li class="excel">Download Excel</li>':"",'</ul></div></div>\n                <div id="').concat(o.attr("id")+"_report",'" class="json2agilereport ').concat(i.div_class,'">\n                <table class="report_table">\n                  <thead>\n                    <tr class=').concat(i.sorting?'"agile_sort"':'""',"></tr>\n                  </thead>\n                  <tbody>\n                  </tbody>\n                </table>\n                </div>\n                </div>\n                ")),s("#"+o.attr("id")+"_wrapper,#"+o.attr("id")+"_report .report_table,#"+o.attr("id")+"_report").css({width:"100%",margin:"0 auto"}),s("#"+o.attr("id")+"_report").scroll(function(){s("#"+o.attr("id")+"_report .agile_sort th").css({position:"relative",top:s(this).scrollTop(),background:"#fff"})}),i.csv_download||i.excel_download||s("#"+o.attr("id")+"_wrapper .agile_down").remove(),s("#"+o.attr("id")+"_wrapper .agile_down .csv").click(function(){t.downloadCSV(i)}),s("#"+o.attr("id")+"_wrapper .agile_down .excel").click(function(){}),i.table_header&&s("#"+o.attr("id")+"_wrapper").prepend('<div class="theader">'.concat(i.table_header,"</div>")),t.header_arr.forEach(function(t,a){var e=t.replace(/ /g,"_");s("#"+o.attr("id")+"_report thead tr").append('<th align="'.concat(i.halign[a],'" class="header_th" id="').concat(e,'" data-key="').concat(t,'">').concat(t,"</th>"))}),i.sorting&&t.EnableSorting(i,o)},e.prototype.GenerateBody=function(i,o){var r=this;"lazy_load"==i.report_type||"pagination"==i.report_type?(this.controls.srow=1,this.controls.erow=this.controls.paginationSize):(this.controls.srow=1,this.controls.erow=this.agile_data.length),this.AppendRows(i,o),"pagination"==i.report_type?(s("#"+o.attr("id")+"_wrapper").append('<div class="agile_bottom_tools">\n      <input type="text" id="'.concat(o.attr("id")+"_limit",'" value="').concat(this.controls.paginationSize,'"><span> rows per page</span>\n      <div class="pagination" id="').concat(o.attr("id")+"_pagination",'"></div></div>')),this.SetPagination(i,o),s("#"+o.attr("id")+"_limit").change(function(){r.controls.paginationSize=Number(s(this).val()),r.agile_data=i.data,r.controls.srow=1,r.controls.erow=r.controls.paginationSize,s("#"+o.attr("id")+"_report tbody").html(""),r.AppendRows(i,o),r.SetPagination(i,o),i.callback(r)})):"lazy_load"==i.report_type&&s("#"+o.attr("id")+"_report").scrollTop(0).scroll(function(t){var a=s(this),e=a.children("table");a.scrollTop()>=e.height()-a.height()&&(this.controls.srow=this.controls.current_position+1,this.controls.erow=this.controls.current_position+this.controls.paginationSize,this.AppendRows(i,o),i.callback(r))})},e.prototype.AppendRows=function(o,t){var r=this;if(!(r.agile_data.length<r.controls.srow)){r.controls.erow=r.agile_data.length<r.controls.erow?r.agile_data.length:r.controls.erow;for(var a=r.controls.srow-1;a<r.controls.erow;a++)r.temp=r.agile_data[a],r.html="<tr>",r.header_arr.forEach(function(t,a){var e=o.halign[a],i=t.replace(/ /g,"_")+"_td";"$"==r.temp[t].toString().charAt(0)&&(e="right"),"%"==r.temp[t].toString().charAt(r.temp[t].length-1)&&(e="center"),r.html+='<td class="'.concat(i,'" align="').concat(e,'">\n        ').concat(-1<JSON.stringify(o.dtformatcols).indexOf('"'+t+'"')?r.FormatDate(new Date(r.temp[t]),o.dtformatcols[t]):-1<JSON.stringify(o.numformatcols).indexOf('"'+t+'"')?r.FormatNumber(r.temp[t],o.numformatcols[t]):r.temp[t],"</td>")}),r.html+="</tr>",s("#"+t.attr("id")+"_report tbody").append(r.html);r.controls.current_position=r.controls.erow}},e.prototype.FormatNumber=function(t,a){return t&&(a.decimals&&(t=t.toFixed(a.decimals).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")),a.number_prefix&&Number(t.replace(/\,/g,""))<0?t='<span class="negative">('+a.number_prefix+t.replace(/\-/,"")+")</span>":a.number_prefix?t=a.number_prefix+t:a.number_suffix&&Number(t.replace(/\,/g,""))<0?t='<span class="negative">('+t.replace(/\-/,"")+a.number_suffix+")</span>":a.number_suffix&&(t+=a.number_suffix)),t},e.prototype.FormatDate=function(t,a){return"dd-mm-yyyy"==a?t.getDate()+"-"+(t.getMonth()+1)+"-"+t.getFullYear():"dd/mm/yyyy"==a?t.getDate()+"-"+(t.getMonth()+1)+"-"+t.getFullYear():"mm-dd-yyyy"==a?t.getMonth()+1+"-"+t.getDate()+"-"+t.getFullYear():"mm/dd/yyyy"==a?t.getMonth()+1+"/"+t.getDate()+"/"+t.getFullYear():"dd/mon/yyyy"==a?t.getDate()+"/"+this.SortMonth[t.getMonth()]+"/"+t.getFullYear():"dd-mon-yyyy"==a?t.getDate()+"-"+this.SortMonth[t.getMonth()]+"-"+t.getFullYear():"dd mon yyyy"==a?t.getDate()+" "+this.SortMonth[t.getMonth()]+" "+t.getFullYear():"dd month yyyy"==a?t.getDate()+" "+this.FullMonth[t.getMonth()]+" "+t.getFullYear():"month dd,yyyy"==a?this.FullMonth[t.getMonth()]+" "+t.getDate()+","+t.getFullYear():this.SortMonth[t.getMonth()]+"_"+t.getDate()+"_"+t.getFullYear()},e.prototype.EnableSorting=function(a,e){var i=this;s("#"+e.attr("id")+"_report th").click(function(){s("#"+e.attr("id")+"_container").addClass("loading");var t=s(this).data("key");s(this).hasClass("asc")?(s("#"+e.attr("id")+"_report th").removeClass("asc").removeClass("desc"),i.SortByKeyDesc(a.data,t),s(this).addClass("desc")):(s("#"+e.attr("id")+"_report th").removeClass("asc").removeClass("desc"),i.SortByKey(a.data,t),s(this).addClass("asc")),s("#"+e.attr("id")+"_report tbody").html(""),"lazy_load"==a.report_type||"pagination"==a.report_type?(i.controls.srow=1,i.controls.erow=i.controls.paginationSize):(i.controls.srow=1,i.controls.erow=a.data.length),i.AppendRows(a,e),i.SetPagination(a,e),s("#"+e.attr("id")+"_container").removeClass("loading"),a.callback.call(this)})},e.prototype.SortByKey=function(t,o){return t.sort(function(t,a){var e=t[o],i=a[o];return"$"==t[o].toString().charAt(0)&&(e=Number(t[o].toString().replace(/\D/g,""))),"$"==a[o].toString().charAt(0)&&(i=Number(a[o].toString().replace(/\D/g,""))),"%"==t[o].toString().charAt(t[o].toString().length-1)&&(e=Number(t[o].toString().replace(/\D/g,""))),"%"==a[o].toString().charAt(a[o].toString().length-1)&&(i=Number(a[o].toString().replace(/\D/g,""))),e<i?-1:i<e?1:0})},e.prototype.SortByKeyDesc=function(t,o){return t.sort(function(t,a){var e=t[o],i=a[o];return"$"==t[o].toString().charAt(0)&&(e=Number(t[o].toString().replace(/\D/g,""))),"$"==a[o].toString().charAt(0)&&(i=Number(a[o].toString().replace(/\D/g,""))),"%"==t[o].toString().charAt(t[o].toString().length-1)&&(e=Number(t[o].toString().replace(/\D/g,""))),"%"==a[o].toString().charAt(a[o].toString().length-1)&&(i=Number(a[o].toString().replace(/\D/g,""))),i<e?-1:e<i?1:0})},e.prototype.SetPagination=function(o,r){var t,n=this,a=Math.ceil(n.controls.current_position/n.controls.paginationSize);for(n.html='<a href="javascript:void(0)" class="agile_prevset">&lt;&lt;</a><a href="javascript:void(0)" class="agile_prev">&lt;</a>',t=1;t<=Math.ceil(n.agile_data.length/n.controls.paginationSize);t++)n.html+=t==a?'<a href="javascript:void(0)" class="active">'.concat(t,"</a>"):3<t?'<a href="javascript:void(0)" class="agile_hide">'.concat(t,"</a>"):'<a href="javascript:void(0)">'.concat(t,"</a>");n.html+='<a href="javascript:void(0)" class="agile_next">&gt;</a><a href="javascript:void(0)" class="agile_nextset">&gt;&gt;</a>',s("#"+r.attr("id")+"_pagination").html(n.html),t<=4&&s("#"+r.attr("id")+"_pagination a.agile_prevset,#"+r.attr("id")+"_pagination a.agile_nextset").remove(),3==s("#"+r.attr("id")+"_pagination a").length&&s("#"+r.attr("id")+"_pagination a.agile_prev, #"+r.attr("id")+"_pagination a.agile_next").remove(),s("#"+r.attr("id")+"_pagination a").click(function(){if(!(s(this).hasClass("agile_prev")||s(this).hasClass("agile_next")||s(this).hasClass("agile_nextset")||s(this).hasClass("agile_prevset"))){var t=s(this).text();s("#"+r.attr("id")+"_container").addClass("loading"),n.controls.srow=(t-1)*n.controls.paginationSize+1,n.controls.erow=n.controls.srow+n.controls.paginationSize-1,s("#"+r.attr("id")+"_report tbody").html(""),n.AppendRows(o,r),s("#"+r.attr("id")+"_pagination a.active").removeClass("active"),s(this).addClass("active"),s("#"+r.attr("id")+"_container").removeClass("loading"),o.callback(n)}}),s("#"+r.attr("id")+"_pagination a.agile_prev").click(function(){var t=Number(s("#"+r.attr("id")+"_pagination a.active").text())-1;s("#"+r.attr("id")+"_pagination a.active").hasClass("agile_hide")&&(t=Number(s("#"+r.attr("id")+'_pagination a:not([class*="agile_"])')[0].innerHTML)),0!=t&&(s("#"+r.attr("id")+"_container").addClass("loading"),n.controls.srow=(t-1)*n.controls.paginationSize+1,n.controls.erow=n.controls.srow+n.controls.paginationSize-1,s("#"+r.attr("id")+"_report tbody").html(""),n.AppendRows(o,r),s("#"+r.attr("id")+"_pagination a.active").hasClass("agile_hide")?(s("#"+r.attr("id")+"_pagination a.active:eq(0)").removeClass("active"),s("#"+r.attr("id")+"_pagination a").each(function(){s(this).text()==t&&s(this).addClass("active")})):(s("#"+r.attr("id")+"_pagination a.active").prev().addClass("active"),s("#"+r.attr("id")+"_pagination a.active:eq(1)").removeClass("active"),s("#"+r.attr("id")+"_pagination a").each(function(){s(this).text()==t&&s(this).hasClass("agile_hide")&&(s(this).removeClass("agile_hide"),s(this).next().next().next().addClass("agile_hide"))})),s("#"+r.attr("id")+"_container").removeClass("loading"),o.callback(n))}),s("#"+r.attr("id")+"_pagination a.agile_next").click(function(){var t=Number(s("#"+r.attr("id")+"_pagination a.active").text())+1;s("#"+r.attr("id")+"_pagination a.active").hasClass("agile_hide")&&(t=Number(s("#"+r.attr("id")+'_pagination a:not([class*="agile_"])')[0].innerHTML)),t>Math.ceil(n.agile_data.length/n.controls.paginationSize)||(s("#"+r.attr("id")+"_container").addClass("loading"),n.controls.srow=(t-1)*n.controls.paginationSize+1,n.controls.erow=n.controls.srow+n.controls.paginationSize-1,s("#"+r.attr("id")+"_report tbody").html(""),n.AppendRows(o,r),s("#"+r.attr("id")+"_pagination a.active").hasClass("agile_hide")?(s("#"+r.attr("id")+"_pagination a.active:eq(0)").removeClass("active"),s("#"+r.attr("id")+"_pagination a").each(function(){s(this).text()==t&&s(this).addClass("active")})):(s("#"+r.attr("id")+"_pagination a.active").next().addClass("active"),s("#"+r.attr("id")+"_pagination a.active:eq(0)").removeClass("active"),s("#"+r.attr("id")+"_pagination a").each(function(){s(this).text()==t&&s(this).hasClass("agile_hide")&&(s(this).removeClass("agile_hide"),s(this).prev().prev().prev().addClass("agile_hide"))})),s("#"+r.attr("id")+"_container").removeClass("loading"),o.callback(n))}),s("#"+r.attr("id")+"_pagination a.agile_nextset").click(function(){var a=s("#"+r.attr("id")+'_pagination a:not([class*="agile_"])'),e=Number(a[a.length-1].innerHTML);if(e&&e!=Math.ceil(n.agile_data.length/n.controls.paginationSize)){for(var t=function(t){s("#"+r.attr("id")+"_pagination a").each(function(){s(this).text()==e+t&&s(this).hasClass("agile_hide")&&(s(this).removeClass("agile_hide"),s(a[t-1]).addClass("agile_hide"))})},i=1;i<=3;i++)t(i);o.callback(n)}}),s("#"+r.attr("id")+"_pagination a.agile_prevset").click(function(){var a=s("#"+r.attr("id")+'_pagination a:not([class*="agile_"])'),e=Number(a[0].innerHTML);if(e&&1!=e){for(var t=function(t){s("#"+r.attr("id")+"_pagination a").each(function(){s(this).text()==e-t&&s(this).hasClass("agile_hide")&&(s(this).removeClass("agile_hide"),s(a[a.length-t]).addClass("agile_hide"))})},i=1;i<=3;i++)t(i);o.callback(n)}})},e.prototype.FilterReport=function(r,a){var e,i,o,n=this;s("#"+a.attr("id")+"_input").bind("change paste keyup",function(){s("#"+a.attr("id")+"_container").addClass("loading"),s("#"+a.attr("id")+"_report thead th").removeClass("asc").removeClass("desc")}),s("#"+a.attr("id")+"_input").bind("change paste keyup",(e=function(t){var o=s(this).val().toUpperCase();n.html="",n.agile_data=[],0<o.length?(r.data.forEach(function(e,i){n.header_arr.forEach(function(t,a){n.temp=e[t],-1<n.temp.toString().toUpperCase().indexOf(o)&&(n.agile_data.push(r.data[i]),-1==n.html.indexOf(e[t])&&(n.html=n.html+"<li>".concat(e[t],"</li>")))})}),s("#"+a.attr("id")+"_container ul.agile_suggest").html(n.html),s("#"+a.attr("id")+"_input").is(":focus")&&s("#"+a.attr("id")+"_container ul.agile_suggest").show(),s("#"+a.attr("id")+"_container ul.agile_suggest li").click(function(){s("#"+a.attr("id")+"_input").val(s(this).text())})):n.agile_data=r.data,n.controls.srow=1,n.controls.erow=n.controls.paginationSize,s("#"+a.attr("id")+"_report tbody").html(""),n.AppendRows(r,a),n.SetPagination(r,a),"pagination"==r.report_type&&0==n.agile_data.length?s("#"+a.attr("id")+"_wrapper .agile_bottom_tools").hide():s("#"+a.attr("id")+"_wrapper .agile_bottom_tools").show(),0==n.agile_data.length&&s("#"+a.attr("id")+"_report tbody").append('<tr><td align="center" colspan="'.concat(n.header_arr.length,'" style="font-size: 11px;color: #d40e0e;font-weight: bold;">No Matching Record !</td></tr>')),s("#"+a.attr("id")+"_container").removeClass("loading"),r.callback(n)},i=700,o=0,function(){var t=this,a=arguments;clearTimeout(o),o=setTimeout(function(){e.apply(t,a)},i||0)})),s(l).mouseup(function(){s("#"+a.attr("id")+"_container ul.agile_suggest").hide()})},e.prototype.destroy=function(t,a){this.header_arr=[],this.html="",this.temp="",this.controls={paginationSize:0,srow:"",erow:"",current_position:""},this.agile_data=[],a.html("")},e.prototype.downloadCSV=function(t){var a=l.createElement("a");a.href="data:text/csv;charset=utf-8,"+this.ConvertToCSV(this.agile_data,t),a.target="_blank",a.download=t.csv_file_name.replace(".csv","")+"_"+this.FormatDate(new Date)+"_"+(new Date).getHours()+"_"+(new Date).getMinutes()+"_"+(new Date).getSeconds()+".csv",a.click()},e.prototype.ConvertToCSV=function(t,a){var e="object"!=_typeof(t)?JSON.parse(t):t,i="",o="";for(var r in this.header_arr)""!=o&&(o+=","),o+=this.header_arr[r];i+=o+"\r\n";for(var n=0;n<e.length;n++){for(var s in o="",e[n]){var l=e[n][s];""!=o&&(o+=","),-1<(l=-1<JSON.stringify(a.dtformatcols).indexOf('"'+s+'"')?this.FormatDate(new Date(l),a.dtformatcols[s]):-1<JSON.stringify(a.numformatcols).indexOf('"'+s+'"')?this.FormatNumber(l,a.numformatcols[s]):l).toString().indexOf(",")&&(l='"'+l+'"'),o+=l}i+=o+"\r\n"}return i},s.fn[i]=function(t){return this.each(function(){s.data(this,"plugin_"+i)||s.data(this,"plugin_"+i,new e(this,t))})}}(jQuery,window,document);