"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0,function(n){var o,l,r=[],c=[],h="",g={psize:0,srow:"",erow:"",curr_pos:""},p="",a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],i=["January","February","March","April","May","June","July","August","September","Octomber","November","December"];function d(){if(!(r.length<g.srow)){g.erow=r.length<g.erow?r.length:g.erow,console.log("start->"+g.srow),console.log("End->"+g.erow);for(var e=g.srow-1;e<g.erow;e++)o=r[e],h="<tr>",c.forEach(function(e,t){h+='<td align="'.concat(l.halign[t],'">').concat(-1<JSON.stringify(l.dtformatcols).indexOf('"'+e+'"')?v(new Date(o[e]),l.dtformatcols[e]):-1<JSON.stringify(l.numformatcols).indexOf('"'+e+'"')?_(o[e],l.numformatcols[e]):o[e],"</td>")}),h+="</tr>",n(".json2agilereport tbody").append(h);g.curr_pos=g.erow}}function u(){var e,t=Math.ceil(g.curr_pos/g.psize);for(h='<a href="javascript:void(0)" class="agile_prevset">&lt;&lt;</a><a href="javascript:void(0)" class="agile_prev">&lt;</a>',e=1;e<=Math.ceil(r.length/g.psize);e++)h+=e==t?'<a href="javascript:void(0)" class="active">'.concat(e,"</a>"):3<e?'<a href="javascript:void(0)" class="agile_hide">'.concat(e,"</a>"):'<a href="javascript:void(0)">'.concat(e,"</a>");h+='<a href="javascript:void(0)" class="agile_next">&gt;</a><a href="javascript:void(0)" class="agile_nextset">&gt;&gt;</a>',n(".pagination").html(h),e<=4&&n("a.agile_prevset,a.agile_nextset").remove(),3==n(".agile_bottom_tools .pagination a").length&&n("a.agile_prev,a.agile_next").remove(),n(".pagination a").click(function(){if(!(n(this).hasClass("agile_prev")||n(this).hasClass("agile_next")||n(this).hasClass("agile_nextset")||n(this).hasClass("agile_prevset"))){var e=n(this).text();n(".agile_top_tools").addClass("loading"),g.srow=(e-1)*g.psize+1,g.erow=g.srow+g.psize-1,n(".json2agilereport tbody").html(""),d.call(this),n(".pagination a.active").removeClass("active"),n(this).addClass("active"),n(".agile_top_tools").removeClass("loading"),l.callback.call(this)}}),n(".pagination a.agile_prev").click(function(){var e=Number(n(".pagination a.active").text())-1;n(".pagination a.active").hasClass("agile_hide")&&(e=Number(n('.pagination a:not([class*="agile_"])')[0].innerHTML)),0!=e&&(n(".agile_top_tools").addClass("loading"),g.srow=(e-1)*g.psize+1,g.erow=g.srow+g.psize-1,n(".json2agilereport tbody").html(""),d.call(this),n(".pagination a.active").hasClass("agile_hide")?(n(".pagination a.active:eq(0)").removeClass("active"),n(".pagination a").each(function(){n(this).text()==e&&n(this).addClass("active")})):(n(".pagination a.active").prev().addClass("active"),n(".pagination a.active:eq(1)").removeClass("active"),n(".pagination a").each(function(){n(this).text()==e&&n(this).hasClass("agile_hide")&&(n(this).removeClass("agile_hide"),n(this).next().next().next().addClass("agile_hide"))})),n(".agile_top_tools").removeClass("loading"),l.callback.call(this))}),n(".pagination a.agile_next").click(function(){var e=Number(n(".pagination a.active").text())+1;n(".pagination a.active").hasClass("agile_hide")&&(e=Number(n('.pagination a:not([class*="agile_"])')[0].innerHTML)),e>Math.ceil(r.length/g.psize)||(n(".agile_top_tools").addClass("loading"),g.srow=(e-1)*g.psize+1,g.erow=g.srow+g.psize-1,n(".json2agilereport tbody").html(""),d.call(this),n(".pagination a.active").hasClass("agile_hide")?(n(".pagination a.active:eq(0)").removeClass("active"),n(".pagination a").each(function(){n(this).text()==e&&n(this).addClass("active")})):(n(".pagination a.active").next().addClass("active"),n(".pagination a.active:eq(0)").removeClass("active"),n(".pagination a").each(function(){n(this).text()==e&&n(this).hasClass("agile_hide")&&(n(this).removeClass("agile_hide"),n(this).prev().prev().prev().addClass("agile_hide"))})),n(".agile_top_tools").removeClass("loading"),l.callback.call(this))}),n(".pagination a.agile_nextset").click(function(){var t=n('.pagination a:not([class*="agile_"])'),a=Number(t[t.length-1].innerHTML);if(a&&a!=Math.ceil(r.length/g.psize)){for(var e=function(e){n(".pagination a").each(function(){n(this).text()==a+e&&n(this).hasClass("agile_hide")&&(n(this).removeClass("agile_hide"),n(t[e-1]).addClass("agile_hide"))})},i=1;i<=3;i++)e(i);l.callback.call(this)}}),n(".pagination a.agile_prevset").click(function(){var t=n('.pagination a:not([class*="agile_"])'),a=Number(t[0].innerHTML);if(a&&1!=a){for(var e=function(e){n(".pagination a").each(function(){n(this).text()==a-e&&n(this).hasClass("agile_hide")&&(n(this).removeClass("agile_hide"),n(t[t.length-e]).addClass("agile_hide"))})},i=1;i<=3;i++)e(i);l.callback.call(this)}})}function f(){if(!(this instanceof f))return new f;this.SheetNames=[],this.Sheets={}}function _(e,t){return e&&(t.decimals&&(e=e.toFixed(t.decimals).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")),t.number_prefix&&Number(e.replace(/\,/g,""))<0?e='<span class="negative">('+t.number_prefix+e.replace(/\-/,"")+")</span>":t.number_prefix?e=t.number_prefix+e:t.number_suffix&&Number(e.replace(/\,/g,""))<0?e='<span class="negative">('+e.replace(/\-/,"")+t.number_suffix+")</span>":t.number_suffix&&(e+=t.number_suffix)),e}function v(e,t){return"dd-mm-yyyy"==t?e.getDate()+"-"+(e.getMonth()+1)+"-"+e.getFullYear():"dd/mm/yyyy"==t?e.getDate()+"-"+(e.getMonth()+1)+"-"+e.getFullYear():"mm-dd-yyyy"==t?e.getMonth()+1+"-"+e.getDate()+"-"+e.getFullYear():"mm/dd/yyyy"==t?e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear():"dd/mon/yyyy"==t?e.getDate()+"/"+a[e.getMonth()]+"/"+e.getFullYear():"dd-mon-yyyy"==t?e.getDate()+"-"+a[e.getMonth()]+"-"+e.getFullYear():"dd mon yyyy"==t?e.getDate()+" "+a[e.getMonth()]+" "+e.getFullYear():"dd month yyyy"==t?e.getDate()+" "+i[e.getMonth()]+" "+e.getFullYear():"month dd,yyyy"==t?i[e.getMonth()]+" "+e.getDate()+","+e.getFullYear():a[e.getMonth()]+"_"+e.getDate()+"_"+e.getFullYear()}n.fn.agilereport=function(e){if("destroy"!=e){var t=[];if(e.data&&0!=e.data.length){for(var a in e.data[0])c.push(a),t.push("left");return l=n.extend({div_class:"",halign:t,no_of_rows:15,dtformatcols:{},csv_download:!0,csv_file_name:"data.csv",excel_download:!0,excel_file_name:"data.xlsx",excel_parameter_tab:!1,excel_parameter_string:"",numformatcols:{},sorting:!0,report_type:"lazy_load",callback:function(){console.log("callback not defined:"+this.innerHTML)}},e),g.psize=Number(l.no_of_rows),function(){this.html('<div class="agile_wrapper">\n                <div class="agile_top_tools"><input type="search" placeholder="Search"><ul class="agile_suggest"></ul><div class="agile_down"><ul>'.concat(l.csv_download?'<li class="csv">Download CSV</li>':"").concat(l.excel_download?'<li class="excel">Download Excel</li>':"",'</ul></div></div>\n                <div class="json2agilereport ').concat(l.div_class,'">\n                <table>\n                  <thead>\n                    <tr class=').concat(l.sorting?'"agile_sort"':'""',"></tr>\n                  </thead>\n                  <tbody>\n                  </tbody>\n                </table>\n                </div>\n                </div>\n                ")),l.csv_download||l.excel_download||n(".agile_down").remove();n(".agile_down .csv").click(function(){var e;(e=document.createElement("a")).href="data:text/csv;charset=utf-8,"+function(e){var t="object"!=_typeof(e)?JSON.parse(e):e,a="",i="";for(var s in c)""!=i&&(i+=","),i+=c[s];a+=i+"\r\n";for(var o=0;o<t.length;o++){for(var s in i="",t[o]){var n=t[o][s];""!=i&&(i+=","),-1<(n=-1<JSON.stringify(l.dtformatcols).indexOf('"'+s+'"')?v(new Date(n),l.dtformatcols[s]):-1<JSON.stringify(l.numformatcols).indexOf('"'+s+'"')?_(n,l.numformatcols[s]):n).toString().indexOf(",")&&(n='"'+n+'"'),i+=n}a+=i+"\r\n"}return a}(r),e.target="_blank",e.download=l.csv_file_name.replace(".csv","")+"_"+v(new Date)+"_"+(new Date).getHours()+"_"+(new Date).getMinutes()+"_"+(new Date).getSeconds()+".csv",e.click()}),n(".agile_down .excel").click(function(){!function(){var t={};t.options={fileName:l.excel_file_name.replace(".xlsx","")+"_"+v(new Date)+"_"+(new Date).getHours()+"_"+(new Date).getMinutes()+"_"+(new Date).getSeconds()},t.tableData=[{sheetName:l.excel_file_name.replace(".xlsx",""),data:[]}];var i=[],s={},o={};if(c.forEach(function(e){i.push({style:{font:{bold:!0},fill:{patternType:"solid",fgColor:{rgb:"cccccccc"}},alignment:{horizontal:"center"}},text:e}),-1<JSON.stringify(l.numformatcols).indexOf('"'+e+'"')&&(o[e]=function(e){var t,a="###,###,###,###,##0.";if(e.decimals)for(t=0;t<e.decimals;t++)a+="0";return a=a.replace(/\.$/,""),e.number_prefix&&(a=e.number_prefix+a),e.number_suffix&&(a+=e.number_suffix),a}(l.numformatcols[e]))}),t.tableData[0].data.push(i),r.forEach(function(a){i=[],c.forEach(function(e,t){s={style:{alignment:{horizontal:l.halign[t]}},text:-1<JSON.stringify(l.dtformatcols).indexOf('"'+e+'"')?v(new Date(a[e]),l.dtformatcols[e]):a[e]},-1<JSON.stringify(l.numformatcols).indexOf('"'+e+'"')&&(s.format=o[e]),i.push(s)}),t.tableData[0].data.push(i)}),l.excel_parameter_tab){t.tableData.push({sheetName:"Parameters",data:[]});var e=l.excel_parameter_string.replace("Filters:","").split(",");e.forEach(function(e){(i=[{style:{font:{bold:!0}},text:e.split("=")[0].trim()}]).push({text:e.split("=")[1].trim()}),t.tableData[1].data.push(i)})}p.export(t.tableData,t.options)}()}),l.table_header&&n(".agile_wrapper").prepend('<div class="theader">'.concat(l.table_header,"</div>"));c.forEach(function(e,t){n(".json2agilereport thead tr").append('<th align="'.concat(l.halign[t],'" data-key="').concat(e,'">').concat(e,"</th>"))}),l.sorting&&n("tr.agile_sort th").click(function(){n(".agile_top_tools").addClass("loading");var s,o,e=n(this).data("key");n(this).hasClass("asc")?(n("tr.agile_sort th").removeClass("asc").removeClass("desc"),o=e,r.sort(function(e,t){var a=e[o],i=t[o];return i<a?-1:a<i?1:0}),n(this).addClass("desc")):(n("tr.agile_sort th").removeClass("asc").removeClass("desc"),s=e,r.sort(function(e,t){var a=e[s],i=t[s];return a<i?-1:i<a?1:0}),n(this).addClass("asc")),n(".json2agilereport tbody").html(""),"lazy_load"==l.report_type||"pagination"==l.report_type?(g.srow=1,g.erow=g.psize):(g.srow=1,g.erow=r.length),d.call(this),u(),n(".agile_top_tools").removeClass("loading"),l.callback.call(this)})}.call(this),r=l.data,function(){"lazy_load"==l.report_type||"pagination"==l.report_type?(g.srow=1,g.erow=g.psize):(g.srow=1,g.erow=r.length);d.call(this),"pagination"==l.report_type?(n(".agile_wrapper").append('<div class="agile_bottom_tools"><input type="text" value="'.concat(g.psize,'"><span> rows per page</span><div class="pagination"></div></div>')),u(),n(".agile_bottom_tools input").change(function(){console.log("new row->"+n(this).val()),g.psize=Number(n(this).val()),r=l.data,g.srow=1,g.erow=g.psize,n(".json2agilereport tbody").html(""),d.call(this),u(),l.callback.call(this)})):"lazy_load"==l.report_type&&n(".json2agilereport").scrollTop(0).scroll(function(e){var t=n(this),a=t.children("table");t.scrollTop()>=a.height()-t.height()&&(g.srow=g.curr_pos+1,g.erow=g.curr_pos+g.psize,d.call(this),l.callback.call(this))})}.call(this),function(){n('.agile_top_tools input[type="search"]').bind("change paste keyup",function(){n(".agile_top_tools").addClass("loading"),n("tr.agile_sort th").removeClass("asc").removeClass("desc")}),n('.agile_top_tools input[type="search"]').bind("change paste keyup",(a=function(e){var s=n(this).val().toUpperCase();h="",r=[],0<s.length?(l.data.forEach(function(a,i){c.forEach(function(e,t){-1<(o=a[e]).toString().toUpperCase().indexOf(s)&&(r.push(l.data[i]),-1==h.indexOf(a[e])&&(h+="<li>".concat(a[e],"</li>")))})}),n("ul.agile_suggest").html(h),n('.agile_top_tools input[type="search"]').is(":focus")&&n("ul.agile_suggest").show(),n("ul.agile_suggest li").click(function(){n(".agile_top_tools input").val(n(this).text())})):r=l.data,g.srow=1,g.erow=g.psize,n(".json2agilereport tbody").html(""),d.call(this),u(),"pagination"==l.report_type&&0==r.length?n(".agile_bottom_tools").hide():n(".agile_bottom_tools").show(),0==r.length&&n(".json2agilereport tbody").append('<tr><td align="center" colspan="'.concat(c.length,'" style="font-size: 11px;color: #d40e0e;font-weight: bold;">No Matching Record !</td></tr>')),n(".agile_top_tools").removeClass("loading"),l.callback.call(this)},i=700,s=0,function(){var e=this,t=arguments;clearTimeout(s),s=setTimeout(function(){a.apply(e,t)},i||0)})),n(document).mouseup(function(){n(".agile_suggest").hide()});var a,i,s}.call(this),n(".json2agilereport").parent("div").css({width:n(".json2agilereport").css("width"),margin:"0 auto"}),n(".json2agilereport table").css("width",n(".json2agilereport table").css("width")),l.callback.call(this),p||function(){if(void 0===h&&"undefined"!=typeof require)var h=require("xlsx");p={config:{fileName:"report",extension:".xlsx",sheetName:"Sheet",fileFullName:"report.xlsx",header:!0,createEmptyRow:!0,maxCellWidth:20},worksheetObj:{},rowCount:0,wsColswidth:[],merges:[],worksheet:{},range:{},init:function(e){if(this.reset(),e)for(var t in this.config)e.hasOwnProperty(t)&&(this.config[t]=e[t]);this.config.fileFullName=this.config.fileName+this.config.extension},reset:function(){this.range={s:{c:1e7,r:1e7},e:{c:0,r:0}},this.worksheetObj={},this.rowCount=0,this.wsColswidth=[],this.merges=[],this.worksheet={}},parse2Int0:function(e){return e=parseInt(e)},cellWidth:function(e,t){var a=e&&1.3*e.length;this.wsColswidth[t]?a>this.wsColswidth[t].wch&&(this.wsColswidth[t]={wch:a}):this.wsColswidth[t]={wch:a}},cellWidthValidate:function(){for(var e in this.wsColswidth)this.wsColswidth[e].wch>this.config.maxCellWidth?this.wsColswidth[e].wch=this.config.maxCellWidth:(!this.wsColswidth[e].wch||this.wsColswidth[e].wch<10)&&(this.wsColswidth[e].wch=10)},datenum:function(e,t){t&&(e+=1462);var a=Date.parse(e);return(a-new Date(Date.UTC(1899,11,30)))/864e5},setCellDataType:function(e){"number"==typeof e.v?e.t="n":"boolean"==typeof e.v?e.t="b":e.v instanceof Date?(e.t="n",e.z=h.SSF._table[14],e.v=this.datenum(e.v)):e.t="s"},jhAddRow:function(e){for(var t in e){t=this.parse2Int0(t);var a=e[t];this.range.s.r>this.rowCount&&(this.range.s.r=this.rowCount),this.range.s.c>t&&(this.range.s.c=t),this.range.e.r<this.rowCount&&(this.range.e.r=this.rowCount),this.range.e.c<t&&(this.range.e.c=t);var i=null;a.hasOwnProperty("text")&&(i=a.text);var s={v:i};a.hasOwnProperty("format")&&(s.z=a.format);var o=!0;if(a.hasOwnProperty("merge")){var n=a.merge;o=!1;var l=t,r=this.rowCount;n.hasOwnProperty("c")&&(l=t+parseInt(n.c)),n.hasOwnProperty("r")&&(r=this.rowCount+parseInt(n.r)),this.merges.push({s:{r:this.rowCount,c:t},e:{r:r,c:l}})}if(o&&this.cellWidth(s.v,t),null!==s.v){var c=h.utils.encode_cell({c:t,r:this.rowCount});this.setCellDataType(s),a.hasOwnProperty("style")&&(s.s=a.style),this.worksheet[c]=s}}this.rowCount++},createWorkSheet:function(){for(var e in this.worksheetObj.data)this.jhAddRow(this.worksheetObj.data[e]);return this.cellWidthValidate(),this.worksheet["!merges"]=this.merges,this.worksheet["!cols"]=this.wsColswidth,this.range.s.c<1e7&&(this.worksheet["!ref"]=h.utils.encode_range(this.range)),this.worksheet},s2ab:function(e){for(var t=new ArrayBuffer(e.length),a=new Uint8Array(t),i=0;i!=e.length;++i)a[i]=255&e.charCodeAt(i);return t},getBlob:function(e,t){this.init(t);var a=new f;for(var i in e){this.reset(),this.worksheetObj=e[i];var s=this.config.sheetName+i;this.worksheetObj.hasOwnProperty("sheetName")&&(s=this.worksheetObj.sheetName),this.createWorkSheet(),a.SheetNames.push(s),a.Sheets[s]=this.worksheet}var o=h.write(a,{bookType:"xlsx",bookSST:!0,type:"binary"}),n=new Blob([this.s2ab(o)],{type:"application/octet-stream"});return n},export:function(e,t){saveAs(this.getBlob(e,t),this.config.fileFullName)}}}(),this}this.html("No Data Found !").addClass("agile_no_data")}else(function(){r=[],c=[],g={psize:0,srow:h="",erow:"",curr_pos:""},p="",n(".agile_wrapper,.agile_wrapper *,.agile_down .excel,.agile_down .csv").off(),this.html("")}).call(this)}}(jQuery);var _default=$.fn.agilereport;exports.default=_default;